<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanban Board</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <!-- Main Styles - –ù–æ–≤—ã–π –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –¥–∏–∑–∞–π–Ω -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/auth.css">
    <link rel="stylesheet" href="css/card.css?v=1">
    <link rel="stylesheet" href="css/filters.css">
    <link rel="stylesheet" href="css/dragdrop.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/trash.css">
    <link rel="stylesheet" href="css/checklist.css">
</head>
<body>
    <header>
        <div class="header-content">
            <div class="header-title">
                <h1>Kanban Board</h1>
                <p class="subtitle">–£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ</p>
            </div>
            <div class="header-actions">
                <!-- –ü–æ–∏—Å–∫ -->
                <div class="search-container">
                    <input
                        type="search"
                        id="search-input"
                        placeholder="üîç –ü–æ–∏—Å–∫ –∑–∞–¥–∞—á..."
                        class="search-input"
                    >
                </div>
                <!-- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω -->
                <div id="auth-buttons" class="auth-buttons">
                    <button class="btn btn-outline" id="show-login-btn">–í–æ–π—Ç–∏</button>
                </div>
                <!-- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω -->
                <div id="user-profile" class="user-profile hidden">
                    <span class="user-email" id="user-email"></span>
                    <button class="btn btn-outline" id="trashBtn" title="–ö–æ—Ä–∑–∏–Ω–∞">üóëÔ∏è –ö–æ—Ä–∑–∏–Ω–∞</button>
                    <button class="btn btn-outline" id="settings-btn">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                    <button class="btn btn-outline" id="logout-btn">–í—ã–π—Ç–∏</button>
                </div>
            </div>
        </div>
    </header>

    <!-- –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
    <div class="filters-toolbar">
        <div class="filters-group">
            <select id="user-filter" class="filter-select">
                <option value="my">üë§ –¢–æ–ª—å–∫–æ –º–æ–∏ –∑–∞–¥–∞—á–∏</option>
                <option value="all">üë• –í—Å–µ –∑–∞–¥–∞—á–∏</option>
            </select>

            <select id="priority-filter" class="filter-select">
                <option value="">–í—Å–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã</option>
                <option value="high">üî¥ –í—ã—Å–æ–∫–∏–π</option>
                <option value="medium">üü° –°—Ä–µ–¥–Ω–∏–π</option>
                <option value="low">üü¢ –ù–∏–∑–∫–∏–π</option>
            </select>

            <select id="sort-select" class="filter-select">
                <option value="">–ë–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</option>
                <option value="deadline-asc">üìÖ –î–µ–¥–ª–∞–π–Ω: —Å–Ω–∞—á–∞–ª–∞ –±–ª–∏–∂–∞–π—à–∏–µ</option>
                <option value="deadline-desc">üìÖ –î–µ–¥–ª–∞–π–Ω: —Å–Ω–∞—á–∞–ª–∞ –¥–∞–ª—å–Ω–∏–µ</option>
                <option value="priority">‚ö° –ü–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É</option>
            </select>

            <button id="reset-filters" class="btn btn-secondary">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
        </div>
    </div>

    <!-- Banner —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
    <div id="notification-banner" class="notification-banner hidden"></div>

    <main class="board-container">
        <div class="column" data-column-id="todo">
            <div class="column-header">
                <h2>To Do</h2>
                <span class="card-count">0</span>
            </div>
            <div class="cards-container" id="todo-cards"></div>
            <button class="add-card-btn" data-column-id="todo">
                <span>+</span> –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
            </button>
        </div>

        <div class="column" data-column-id="inProgress">
            <div class="column-header">
                <h2>In Progress</h2>
                <span class="card-count">0</span>
            </div>
            <div class="cards-container" id="inProgress-cards"></div>
            <button class="add-card-btn" data-column-id="inProgress">
                <span>+</span> –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
            </button>
        </div>

        <div class="column" data-column-id="done">
            <div class="column-header">
                <h2>Done</h2>
                <span class="card-count">0</span>
            </div>
            <div class="column-actions">
                <button class="btn btn-bulk-delete" id="bulk-delete-done-btn" title="–ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ">
                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –ø–æ –¥–∞—Ç–µ
                </button>
            </div>
            <div class="cards-container" id="done-cards"></div>
            <button class="add-card-btn" data-column-id="done">
                <span>+</span> –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
            </button>
        </div>
    </main>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
    <div id="auth-modal-overlay" class="modal-overlay hidden">
        <div class="modal auth-modal">
            <div class="modal-header">
                <h2 id="auth-modal-title">–í—Ö–æ–¥</h2>
                <button class="close-btn" id="close-auth-modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å">&times;</button>
            </div>
            <form id="auth-form">
                <div class="form-group">
                    <label for="auth-email">Email *</label>
                    <input
                        type="email"
                        id="auth-email"
                        name="email"
                        placeholder="your@email.com"
                        required
                        autocomplete="email"
                    >
                </div>
                <div class="form-group">
                    <label for="auth-password">–ü–∞—Ä–æ–ª—å *</label>
                    <input
                        type="password"
                        id="auth-password"
                        name="password"
                        placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤"
                        required
                        minlength="6"
                        autocomplete="current-password"
                    >
                </div>
                <div class="form-group hidden" id="auth-nickname-group">
                    <label for="auth-nickname">–ù–∏–∫–Ω–µ–π–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                    <input
                        type="text"
                        id="auth-nickname"
                        name="nickname"
                        placeholder="–ö–∞–∫ –≤–∞—Å –Ω–∞–∑—ã–≤–∞—Ç—å? (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω email)"
                        maxlength="50"
                        autocomplete="off"
                    >
                </div>
                <div id="auth-error" class="auth-error hidden"></div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-cancel" id="auth-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary" id="auth-submit-btn">–í–æ–π—Ç–∏</button>
                </div>
            </form>
            <div class="auth-toggle">
                <span id="auth-toggle-text">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞?</span>
                <button type="button" class="btn-link" id="auth-toggle-btn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ—Ñ–∏–ª—è -->
    <div id="settings-modal-overlay" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è</h2>
                <button class="close-btn" id="close-settings-modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å">&times;</button>
            </div>
            <form id="settings-form">
                <div class="form-group">
                    <label>Email</label>
                    <p id="settings-email" style="color: #666; font-size: 0.9rem; margin: 0.5rem 0;"></p>
                </div>
                <div class="form-group">
                    <label for="settings-nickname">–ù–∏–∫–Ω–µ–π–º *</label>
                    <input
                        type="text"
                        id="settings-nickname"
                        name="nickname"
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º (3-50 —Å–∏–º–≤–æ–ª–æ–≤)"
                        required
                        minlength="3"
                        maxlength="50"
                        autocomplete="off"
                    >
                </div>
                <div id="settings-error" class="auth-error hidden"></div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-cancel" id="settings-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary" id="settings-submit-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ -->
    <div id="modal-overlay" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h2 id="modal-title">–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞</h2>
                <button class="close-btn" id="close-modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å">&times;</button>
            </div>
            <form id="card-form">
                <div class="form-group">
                    <label for="card-title">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ *</label>
                    <input
                        type="text"
                        id="card-title"
                        name="title"
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏"
                        required
                        maxlength="100"
                    >
                </div>
                <div class="form-group">
                    <label for="card-description">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea
                        id="card-description"
                        name="description"
                        placeholder="–î–æ–±–∞–≤—å—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)"
                        rows="4"
                        maxlength="500"
                    ></textarea>
                </div>
                <div class="form-group">
                    <label for="card-priority">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                    <select id="card-priority" name="priority">
                        <option value="low">–ù–∏–∑–∫–∏–π</option>
                        <option value="medium" selected>–°—Ä–µ–¥–Ω–∏–π</option>
                        <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="card-start-date">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞</label>
                        <input type="date" id="card-start-date" name="startDate">
                    </div>
                    <div class="form-group">
                        <label for="card-end-date">–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</label>
                        <input type="date" id="card-end-date" name="endDate">
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-cancel" id="cancel-btn">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
            <!-- –ß–µ–∫–ª–∏—Å—Ç (—Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è) -->
            <div id="card-checklist-container" class="hidden"></div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –º–∞—Å—Å–æ–≤–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ Done -->
    <div id="bulkDeleteModal" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h2>üóëÔ∏è –ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ Done</h2>
                <button class="close-btn" id="closeBulkDelete" aria-label="–ó–∞–∫—Ä—ã—Ç—å">&times;</button>
            </div>
            <form id="bulk-delete-form">
                <div class="form-group">
                    <label>–í—ã–±–µ—Ä–∏—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫:</label>
                    <div class="date-range-buttons">
                        <button type="button" class="btn btn-secondary date-preset" data-days="3">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 –¥–Ω—è</button>
                        <button type="button" class="btn btn-secondary date-preset" data-days="7">–ü–æ—Å–ª–µ–¥–Ω—è—è –Ω–µ–¥–µ–ª—è</button>
                        <button type="button" class="btn btn-secondary date-preset" data-days="30">–ü–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>–ò–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω:</label>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="bulk-delete-start-date">–° –¥–∞—Ç—ã</label>
                            <input type="date" id="bulk-delete-start-date" name="startDate">
                        </div>
                        <div class="form-group">
                            <label for="bulk-delete-end-date">–ü–æ –¥–∞—Ç—É</label>
                            <input type="date" id="bulk-delete-end-date" name="endDate">
                        </div>
                    </div>
                </div>
                <div id="bulk-delete-preview" class="bulk-delete-preview hidden">
                    <p>–ë—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ –∫–∞—Ä—Ç–æ—á–µ–∫: <strong id="bulk-delete-count">0</strong></p>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-cancel" id="bulk-delete-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-danger" id="bulk-delete-submit-btn">–£–¥–∞–ª–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–æ—Ä–∑–∏–Ω—ã -->
    <div id="trashModal" class="modal-overlay hidden">
        <div class="modal trash-modal">
            <div class="modal-header">
                <h2>üóëÔ∏è –ö–æ—Ä–∑–∏–Ω–∞</h2>
                <button class="close-btn" id="closeTrash" aria-label="–ó–∞–∫—Ä—ã—Ç—å">&times;</button>
            </div>
            <div class="trash-filters">
                <div class="form-group">
                    <label for="trashOwnerFilter">–ü–æ–∫–∞–∑–∞—Ç—å:</label>
                    <select id="trashOwnerFilter" class="filter-select">
                        <option value="all">–í—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏</option>
                        <option value="my">–¢–æ–ª—å–∫–æ –º–æ–∏</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="trashSortBy">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
                    <select id="trashSortBy" class="filter-select">
                        <option value="deleted_at">–ü–æ –¥–∞—Ç–µ —É–¥–∞–ª–µ–Ω–∏—è</option>
                        <option value="title">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é</option>
                    </select>
                </div>
                <div class="form-group">
                    <button class="btn btn-danger" id="bulk-delete-trash-btn" title="–ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã">
                        üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –ø–æ –¥–∞—Ç–µ
                    </button>
                </div>
            </div>
            <div id="trashList" class="trash-list">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–¥–µ—Å—å -->
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –º–∞—Å—Å–æ–≤–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã -->
    <div id="bulkDeleteTrashModal" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h2>üóëÔ∏è –ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã</h2>
                <button class="close-btn" id="closeBulkDeleteTrash" aria-label="–ó–∞–∫—Ä—ã—Ç—å">&times;</button>
            </div>
            <form id="bulk-delete-trash-form">
                <div class="form-group">
                    <label>–í—ã–±–µ—Ä–∏—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫:</label>
                    <div class="date-range-buttons">
                        <button type="button" class="btn btn-secondary date-preset-trash" data-days="3">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 –¥–Ω—è</button>
                        <button type="button" class="btn btn-secondary date-preset-trash" data-days="7">–ü–æ—Å–ª–µ–¥–Ω—è—è –Ω–µ–¥–µ–ª—è</button>
                        <button type="button" class="btn btn-secondary date-preset-trash" data-days="30">–ü–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>–ò–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω:</label>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="bulk-delete-trash-start-date">–° –¥–∞—Ç—ã</label>
                            <input type="date" id="bulk-delete-trash-start-date" name="startDate">
                        </div>
                        <div class="form-group">
                            <label for="bulk-delete-trash-end-date">–ü–æ –¥–∞—Ç—É</label>
                            <input type="date" id="bulk-delete-trash-end-date" name="endDate">
                        </div>
                    </div>
                </div>
                <div id="bulk-delete-trash-preview" class="bulk-delete-preview hidden">
                    <p>–ë—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ –Ω–∞–≤—Å–µ–≥–¥–∞ –∫–∞—Ä—Ç–æ—á–µ–∫: <strong id="bulk-delete-trash-count">0</strong></p>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-cancel" id="bulk-delete-trash-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-danger" id="bulk-delete-trash-submit-btn">–£–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- SortableJS for Drag & Drop -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>

    <!-- Application Scripts -->
    <script src="js/config.js"></script>
    <script src="js/services/supabase.js"></script>
    <script src="js/services/authService.js"></script>
    <script src="js/services/profileService.js"></script>
    <script src="js/services/cardService.js"></script>
    <script src="js/services/trashService.js"></script>
    <script src="js/services/checklistService.js"></script>
    <script src="js/services/realtimeService.js"></script>
    <script src="js/utils/dateUtils.js?v=2"></script>
    <script src="js/utils/urlUtils.js?v=2"></script>
    <script src="js/components/auth.js?v=4"></script>
    <script src="js/components/settings.js?v=4"></script>
    <script src="js/components/trash.js"></script>
    <script src="js/components/bulkDelete.js"></script>
    <script src="js/components/search.js"></script>
    <script src="js/components/filters.js"></script>
    <script src="js/components/checklist.js"></script>
    <script src="js/components/notifications.js?v=2"></script>
    <script src="js/dragDrop/sortable.js?v=2"></script>
    <script src="app.js?v=3"></script>
</body>
</html>
